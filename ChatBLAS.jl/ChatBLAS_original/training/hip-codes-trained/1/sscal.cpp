#include "chatblas_hip.h" __global__ void sscal_kernel( int n, float a , float *x ) { int i = blockDim.x * blockIdx.x + threadIdx.x; if (i < n) { x[i] *= a; } } void chatblas_sscal( int n, float a, float *x) { float *d_x; int blockSize = 256; int numBlocks = (n + blockSize - 1) / blockSize; hipMalloc((void **)&d_x, n*sizeof(float)); hipMemcpy(d_x, x, n*sizeof(float), hipMemcpyHostToDevice); hipLaunchKernelGGL(sscal_kernel, dim3(numBlocks), dim3(blockSize), 0, 0, n, a, d_x); hipMemcpy(x, d_x, n*sizeof(float), hipMemcpyDeviceToHost); hipFree(d_x); }